cmake_minimum_required(VERSION 3.15)
project(MyCProject LANGUAGES C)

# 配置C标准
set(CMAKE_C_STANDARD 11)
set(CMAKE_C_STANDARD_REQUIRED ON)

# 设置输出目录（确保与launch.json匹配）
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR})
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR})
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR})

# 包含头文件目录
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/include)

# 添加所有源文件
file(GLOB SOURCES "src/*.c")

# 创建单个可执行文件
add_executable(main ${SOURCES})

# Windows特定配置
if(WIN32)
    # MinGW需要手动链接数学库
    set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} -lm")
    
    # 设置GBK编码（解决中文乱码）
    add_compile_options(-fexec-charset=GBK)
endif()

# 编译器警告选项
target_compile_options(main PRIVATE
    -Wall -Wextra -Wpedantic
)