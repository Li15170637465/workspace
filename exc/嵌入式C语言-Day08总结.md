# 嵌入式 C 语言 - Day08 总结

## 第 12 章 指针 pointer

### 12.1 指针基础

**什么是指针？**

```
指针就是变量，里面存储的是地址。
```

**内存地址**

```
内存划分为多个内存单元，每个内存单元有个数字编号，该编号就是该内存单元的地址。
64位系统，使用64个二进制数据表式内存地址；32位系统使用32个二进制数表示地址。
```

**定义指针的语法：**

一般格式**：**

```c
数据类型关键字 *指针名;
数据类型关键字 *指针名 = 地址;
```

需要注意的是，以下三种定义指针的写法都是合法的：

```c
数据类型关键字 *指针名;
数据类型关键字 * 指针名;
数据类型关键字* 指针名;
```

**取地址运算符&**

```
一元运算符 
无副作用 
表达式的值是地址
```

**取值运算符*（解引用运算符）**

```
一元运算符 
无副作用 
表达式的值是指针指向的值
```

### 12.2 指针运算

#### ① 指针加减整数

```
指针与整数的加减运算，表示指针所指向的内存地址的移动（加，向后移动；减，向前移动），指针移动多少，与指针指向的数据类型有关，数据类型占据多少个字节，每单位就移动多少个字节，比如一个 int *类型指针，+1 向后移动 4 个字节，-2 向前移动 8 个字节。
```

#### ② 指针自增自减

```
指针自增、自减本质上就是指针加减整数，自增地址后移，自减地址前移。
```

#### ③ 同类型指针相减

```
相同类型的指针可以进行减法运算，返回它们之间的距离，即相隔多少个数据单位。高位地址减去低位地址，返回的是正值；低位地址减去高位地址，返回的是负值。
两个下标相减
```

#### ④ 指针比较大小

```
指针之间可以进行比较运算，如 ==、<、 <= 、 >、 >=，比较的是各自指向的内存地址的大小，返回值是 int 类型整数 1 （true）或 0  （false）
```

### 12.3 指针和数组

#### ① 数组名

**数组名和显式定义的指向数组首元素的指针的不同点：**

```
1. 两个标识符类型不同
2. sizeof 计算结果不同
3. 数组名（是标识符常量）不可以重新赋值，指针（是变量）可以重新赋值
```

**数组名和显式定义的指向数组首元素的指针的相同点：**

```
1. 使用 %p 打印数组名，可以得到首元素地址
2. 使用 * 解应用数组名，可以得到首元素的值
3. 数组名可以进行指针运算：加减整数、同类型指针相减、指针比较大小
4. 数组名[下标] 是个语法糖，本质是 *(数组名+下标)
```

> 在特定情况下，数组名可以认为是指向首元素的指针！

#### ② 指针数组（pointer array、array of pointers）

```
是个数组，每个元素都是地址（指针）
```

#### ③ 数组指针（array pointer、a pointer to array）

```
是个指针，指向一个数组
```

#### ④ 字符指针

```
指向字符串字面量常量的字符指针，具有如下特点：
① 可以作为字符串使用，可以%s打印，可以遍历输出每个字符，可以strlen()获取长度
② 相对于字符数组名，字符指针可以修改指针，指向新的字符串
③ 不可以使用下标修改其中某个字符
④ 不能用于获取用户输入的字符串
```

#### ⑤ 总结：

```c
int arr[5] = {10,20,30,40,50};		// arr 数组名
int *ptr = arr;  					// ptr 显式定义的首元素指针
int (*arr_ptr)[5] = &arr;  			// arr_ptr 是数组指针
```

| 标识符  | 性质       | 数据类型   | sizeof 计算结果 | +1 的值              | * 取值（解引用）     | 能否重新赋值(可变性) |
| ------- | ---------- | ---------- | --------------- | -------------------- | -------------------- | -------------------- |
| arr     | 数组名     | int [5]    | 整个数组的大小  | 第二个元素地址       | 首元素值             | 否                   |
| ptr     | 首元素指针 | int *      | 地址大小        | 第二个元素地址       | 首元素值             | 是                   |
| arr_ptr | 数组指针   | int (*)[5] | 地址大小        | 数组后面地址（越界） | 数组名（首元素地址） | 是                   |

### 12.4 指针和函数

#### ① 指针传递（地址传递、引用传递）

**值传递：**

```

```

**指针传递：**

```

```

#### ② 指针函数（英文：pointer function 、 a function returning pointer）

#### ③ 函数指针（function pointer、a pointer to function）

#### ④ 回调函数 callback

## 作业

```
1. 定义函数，实现交换两个变量的值； 函数原型 void exchange(int *, int *)

2. 定义一个函数，接收数组名或首元素指针 和 数组长度 作为参数，计算数组的平均数
   函数原型： int get_avg(int *, int);
   
3. 定义函数，接收一个字符串和字符，统计字符在字符串中出现的次数
   函数原型: int char_count(char *, char)
   
4. 定义函数，返回某个字符在字符串中第一次出现的位置	   
   函数原型: int firstIndex(char *, char)
   
5. 定义函数，返回某个字符在字符串中最后一次出现的位置  
   函数原型: int lastIndex(char *, char)
  
6. 定义函数 实现字符串中小写字母转大写字母； 
   函数原型: char *upperCase(char *)
   
7. 定义函数 实现字符串中大写字母转小写字母；  
   函数原型: char *lowerCase(char *)
   
```
