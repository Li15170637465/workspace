# 嵌入式 C 语言 - Day9 总结

## 第 12 章 指针 pointer

### 12.4 指针和函数

#### ① 指针传递（地址传递、引用传递）

**值传递：**

```
实参的值是非地址类型，实参将自己的值的拷贝传递给形参，形参与实参只有值相等，是两个独立的变量。
```

**指针传递：**

```
实参是地址（指针变量、数组名），形参接收到时地址，函数内部使用形参可以修改外部的数据。
```

#### ② 指针函数（英文：pointer function 、 a function returning pointer）

```
是个函数，返回指针（地址）
```

> **注意：** 指针函数不能返回局部变量的地址，函数调用结束局部变量被销毁；可以返回静态局部变量的地址。

#### ③ 函数指针（英文：function pointer、a pointer to function）

```
是个指针，指向一个函数
```

> **总结：**
>
> 1. 函数的代码存放于内存的代码区，调用函数的本质就是使用函数代码的地址去调用
> 2. 函数名、&函数名、*函数名 都可以获取到函数代码的地址，都可以调用函数。

#### ④ 回调函数 callback

```
函数指针可以作为某个函数的参数来使用的，回调函数就是一个通过函数指针调用的函数。
回调函数作为另一个函数的参数，在另一个函数的内部可以调用回调函数。
```

### 12.5 指针常量/常量指针

#### ① 指针常量（constant pointer）

**概念：**

```
是个常量，值是个地址。
```

**语法：**

```c
类型关键字 *const 指针常量名 = 地址;
```

**特点：**

```
1. 可以修改指向的数据
2. 不可以修改指向//保存的地址不能改变，去存储数据
3. 数组名可以认为是指针常量
```

#### ② 常量指针（a pointer to constant）

**概念：**

```
是个指针，指向一个常量。
```

**语法：**

```c
const 数据类型关键字 *常量指针名 = 地址;
// 或者
数据类型关键字 const *常量指针名 = 地址;
```

> **注意：** 常量指针指向的不一定是真的常量，但是常量指针会把指向的数据当做是常量。

**特点：**

```
1. 不可以修改指向的数据，只可以读取指向的数据
2. 可以修改指向//保存变量地址，指到谁把谁当成常量
3. 函数名、指向字符串字面量常量的字符指针 都可以认为是常量指针
```

### 12.6 多级指针

```
指向指针的指针就是多级指针。
```

### 12.7 空指针

```
赋为NULL 值的指针被称为空指针，NULL 是一个定义在标准库 <stdio.h>中的值为零的宏常量。
声明指针变量的时候，如果没有确切的地址赋值，为指针变量赋一个NULL 值是好的编程习惯。
空指针不可以被解引用。
```

### 12.8 野指针

#### ① 什么是野指针

```
野指针就是指针指向的位置是不可知（随机性，不正确，没有明确限制的）。
```

#### ② 野指针的成因

```
1. 悬空指针（指针未初始化）
2. 指向越界
3. 指向已经释放的内存空间（指向函数中的局部变量，函数调用结束局部变量销毁）
```

#### ③ 如何避免野指针

```
避免上面情况
```

## 第 13 章 自定义数据类型

### 13.1 枚举 enum

#### ① 定义枚举类型

```c
enum 类型名
{
    枚举常量,
    枚举常量,
    枚举常量,
    枚举常量
    ...
}

enum 类型名
{
    枚举常量 = 整数,
    枚举常量,
    枚举常量,
    枚举常量
    ...
}
```

#### ② 根据枚举类型定义枚举变量

```c
第一种 先定义类型，再定义变量
第二种 同时定义类型和变量
第三种 同时定义类型和变量，省略类型名
```

#### ③ 枚举常量（枚举元素、枚举成员）的特点

```
（1）枚举元素的值必须在同一枚举中是唯一的
（2）枚举元素的值必须是整数类型，通常是int
（3）如果没有为枚举元素指定值，编译器会自动为它们分配值，从0开始，依次递增。
（4）定义枚举的时候也可以为枚举元素自定义值，需保证唯一性和整型类型。
```

### 13.2 结构体 struct

#### ① 定义结构体类型

```c
struct 类型名称
{
    成员类型 成员名称;
    成员类型 成员名称;
    成员类型 成员名称;
    成员类型 成员名称;
    成员类型 成员名称;
    ....
}
```

> **注意：**
>
> * 类型名称和成员名称都需要符合标识符规范
> * 结构体的成员类型可以是任意类型（整数、浮点、数组、指针、枚举、结构体）

#### ② 根据结构体类型定义结构体变量

```
第一种方式 先定义类型，再定义变量
第二种方式 同时定义类型和变量
第三种方式 同时定义类型和变量并省略类型名称
```

#### ③ 结构体变量初始化赋值

```
第一种方式：先定义结构体变量，依次给成员赋值
第二种方式：定义结构体变量同时使用大括号给成员赋值
```

#### ④ 结构体变量访问结构体成员

```c
使用 . 运算符
```

#### ⑤ 结构体指针

```
1. 指向结构体变量的指向就是结构体指针
2. 通过结构体指针可以直接使用 -> 访问结构体变量的成员
```

### 作业

```
1) 指针练习
 // 定义二维数组
    int nums[3][4] = {
        {10, 20, 30, 40},
        {100, 200, 300, 400},
        {1000, 2000, 3000, 400}};
 实现如下需求：
   ① 定义指针，将 nums 赋值给该指针
   ② 定义指针，将 &nums 赋值给该指针
   ③ 定义指针，将 nums[1] 赋值给该指针
   ④ 定义指针，将 &nums[1] 赋值给该指针
   ⑤ 定义指针，将 &nums[1][1] 赋值给该指针


2）小狗案例
（1）编写一个Dog结构体，包含name(char *)、age(int)、weight(double)属性。
（2）编写一个say函数，返回字符串，方法返回信息中包含所有成员值。
（3）在main函数中，创建Dog结构体变量，调用say函数，将调用结果打印输出。



```

**作业1的图例**

![作业1的图例](1.png)
